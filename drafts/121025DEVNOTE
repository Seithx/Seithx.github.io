[15:26, 10/12/2025] Ab: ### âœ… *Summary: Debug + Fix Log for YouTube Extraction Automation (yt-dlp + Bash + Python)*

Below is a structured list of *every major issue, **root cause, and **resolution* we encountered while building a consistent workflow to extract all videos and playlists for *KAN 11* and general *childrenâ€™s / Hebrew-only YouTube* searches.

---

### ğŸ§± *Environment & Setup Issues*

* *Issue:* sudo: command not found in MINGW64
  *Cause:* Git Bash on Windows doesnâ€™t include sudo.
  *Fix:* Run apt commands without sudo, or use user-level installs via curl or pip.

* *Issue:* wget: command not found
  *Cause:* MINGW64â€™s minimal install lacks wget.
  *Fix:* Used curl -L -o file instead.

* *Issue:* jq: command not found even after download
  *Cause:* Windows executable jq.exe not callable as jq under Bash.
  *Fix:*

  1. Placed jq.exe in ~/.local/bin/
  2. Created wrapper:

     bash
     echo '#!/usr/bin/env bash
     exec "$HOME/.local/bin/jq.exe" "$@"' > ~/.local/bin/jq
     chmod +x ~/.local/bin/jq
     export PATH="$HOME/.local/bin:$PATH"
     

  âœ… Confirmed via jq --version.

* *Issue:* stdbuf not found
  *Cause:* Not included in MINGW coreutils.
  *Fix:* Removed it. Used PYTHONUNBUFFERED=1 instead for real-time streaming.

---

### âš™ï¸ *yt-dlp Functionality Issues*

* *Issue:* yt-dlp not found (PATH mismatch)
  *Cause:* Installed in virtualenv (.venv/Scripts/yt-dlp).
  *Fix:* Used python -m yt_dlp to ensure correct context.

* *Issue:* yt-dlp hangs or shows no progress
  *Cause:* default buffering in Windows + large â€œuploadsâ€ playlists hold all JSON in memory.
  *Fix:* Added --lazy-playlist to stream JSON per item. Used PYTHONUNBUFFERED=1.

* *Issue:* YouTube consent or age wall blocking output
  *Fix:* Added optional COOKIES="--cookies-from-browser edge" (or chrome).

* *Issue:* Wrong playlist extraction (KAN channel)
  *Fix:* Used direct uploads playlist ID
  https://www.youtube.com/playlist?list=UUKqFqiCe1dCUxRe0_YNZ6gg
  instead of channel handle URL.

---

### ğŸ§¾ *Script Design & Syntax Errors*

* *Issue:* Folder created but nothing happens
  *Cause:* Script stuck at read -r -d '' waiting for NUL.
  *Fix:* Replaced with Bash array QUERIES=( â€¦ ).

* *Issue:* Silent fail due to set -euo pipefail
  *Cause:* Small syntax error caused early exit.
  *Fix:* Added tracing (bash -x, trap 'echo "ERR at lineâ€¦") to catch failing line.

* *Issue:* $-flat-playlist typo
  *Cause:* Mistyped variable expansion â†’ $- is a shell flag variable.
  *Fix:* Corrected to $COOKIES --flat-playlist.

* *Issue:* Broken pipe and Invalid argument spam
  *Cause:* Python script consumed stdin for itself, leaving yt-dlp output unhandled.
  *Fix:* Switched to python -c 'code' "$OUT" "$SAFE" so stdin remains open for JSON streaming.

* *Issue:* Windows CRLF line endings
  *Fix:* Converted scripts with sed -i 's/\r$//' script.sh.

---

### ğŸ“¦ *Functional Refinements*

* *1ï¸âƒ£ KAN 11 Extraction*

  * Needed to directly target the *uploads playlist* using ID UUKqFqiCe1dCUxRe0_YNZ6gg.
  * Used:

    bash
    yt-dlp --flat-playlist --lazy-playlist -j "https://www.youtube.com/playlist?list=UUKqFqiCe1dCUxRe0_YNZ6gg"
    
  * Wrote JSON â†’ TSV pipeline with live progress counters.

* *2ï¸âƒ£ General â€œChildren / Religiousâ€ Search*

  * Combined multiple Hebrew + English queries.
  * Used ytsearchdate for recency.
  * Created unified script looping through all queries.

* *3ï¸âƒ£ Hebrew-only Filtering*

  * Problem: Global results brought Christian / Muslim videos.
  * Fix: Added Unicode-range check for Hebrew letters (\u0590â€“\u05FF) in both title and uploader:

    python
    def heb(s): return any('\u0590' <= ch <= '\u05FF' for ch in s or "")
    if not (heb(title) or heb(uploader)): continue
    
  * Optional: extra Jewish keyword filter for stronger precision.

* *4ï¸âƒ£ Deduplication*

  * Added Python-based TSV deduper by first column (videoId or playlistId).

---

### ğŸ§  *Debugging Strategy that Worked*

1. Use bash -x script.sh 2> debug.log to log line-by-line execution.
2. Add trap 'echo "ERR at line ${LINENO}: ${BASH_COMMAND}" >&2' ERR to print failures.
3. Test individual components interactively:

   bash
   python -m yt_dlp -v --skip-download --print-json "ytsearch5:×™×œ×“×™×"
   
4. Verify outputs after each stage:

   bash
   tail videos.tsv
   tail playlists.tsv
   

---

### âœ… *Final Working Setup*

* *Environment:* Git Bash (MINGW64), Python 3.12, yt-dlp 2025.09.26.
* *Core flags:*

  * --flat-playlist and --lazy-playlist for streaming
  * --skip-download and --print-json for metadata only
  * PYTHONUNBUFFERED=1 for live progress
* *Data flow:* yt-dlp â†’ tee (save JSONL) â†’ inline Python â†’ TSV + progress â†’ dedupe.
* *Result:*

  * Reliable extraction of all uploads from KAN 11.
  * Consistent global searches filtered to Hebrew-only kidsâ€™ videos.
  * Fully automatable Bash + Python workflow, no manual intervention.

---

Would you like me to format this into a Markdown developer note (ready for README or internal doc)?
[16:13, 10/12/2025] ××œ×™×¢×–×¨ ×‘×Ÿ ×™×”×•×“×”: ×‘×•× × ×’×™×“ ×©×–×” ×œ× ×”×™×” ×‘×¡×“×¨ ×¢×“×™×¤×•×™×•×ª, ××‘×œ ×‘×”×—×œ×˜ ×‘×–×‘×–×ª×™ ×¢×œ ×–×” ×–××Ÿ.
×× ×§× ×™× ×§×™,
×”×©××œ×” ××” ×”×‘×™× ×œ×™ ××—×¨ ×‘-value.
×–×” ×”×™×” ×™×—×¡×™×ª ×§×œ, ×•×¨×¦×™×ª×™ ××ª ×”×¤×œ×™×™×œ×™×¡×˜ ×”×™×œ×“×™, ×•×–×” ××©×”×• ×©×™×›×•×œ×ª×™ ×œ×¢×©×•×ª ×¤×”. ××× × ×”-AI ×¢×•×©×” ××ª ×”×›×œ, ××œ× ×¨××™×ª×™ ×©×”×•× ×”×©×ª××© ×‘×‘×™××•×œ×•×¤×•×¨ ×¡×•×¤ ×•×¨×™×§×•×•×¡×˜ ×•×›×œ ××™× ×™ ×“×‘×¨×™× ×©×–×” ×œ×—×œ×¥,
×”× ×—×™×ª×™ ××•×ª×• ×§×¦×ª ×›×“×™ ×œ×—×œ×¥.
××” ×©×”×•×¡×¤×ª×™ ×–×”
××™×š ×§×•×¨××™× ×œ×–×”? ××” ×©×”×•×¡×¤×ª×™ ×–×” ×œ× ×¡×•×ª ×œ×—×œ×¥ ××”×¤×¨×•×™×§×˜ ×©×‘×™×Ÿ ×™×”×•×“×”,
××ª ×›×œ ×”×”×•×’×™× ×©×™×© ×©×,
2742 ××• ×œ× ×˜×•×‘, ××©×”×• ×›×–×”,
××– ×”×•× ×¢×•×‘×¨ ××—×“-××—×“ ×¢×“ ×©×”×•× ×™×’×™×¢ ×œ×¡×•×£, ×¢× ×“×™×œ×™×™ ×©××ª×™×™×—×¡ ×œ×¨×•×‘×•×˜ TXT. ×•×‘× ×•×¡×£,
×× ×™ ×—×•×©×‘ ×©×× ×™ ××¡×™×™× ×‘×›×œ×œ ××ª ×›×œ ×”×¤×œ×™×™×œ×™×¡×˜×™× ×œ×™×œ×“×™×,
×–×• ×©××œ×” ××™×š ×œ×¢×‘×•×¨ ×¡×¨×˜×•×Ÿ-×¡×¨×˜×•×Ÿ,
×™×© ×“×¨×š ×œ×¢×©×•×ª ××ª ×–×” ××•×˜×•××˜×™×ª,
××•×œ×™ ×‘×›×œ×œ ×œ× ×¦×¨×™×š ××ª ×–×”,
×•×œ×™×¦×•×¨ ××™×–×©×”×• ×¤×œ×™×™×œ×™×¡×˜.
×’× ×™×¦×™×¨×ª ×”×¤×œ×™×™×œ×™×¡×˜ ×–×” ×”×—×•×¤×¨, ××¤×©×¨ ×œ×¢×©×•×ª ××ª ×–×” ×’× ×¢× ×”-YLT-DLP,
××‘×œ ×™×© ××™×–×” E.P.I.×œ×’×•×’×™, ××– ×–×” ××¡×•×‘×š, ×œ× ×‘× ×œ×™ ×œ×”×ª×¢×¡â€¦
[16:27, 10/12/2025] Ab: × ×›× ×¡ ×œ×¢×•××§ ×™×•×ª×¨ ××“×™, ××•×œ×™ ×œ×”××™×¨ ×”×›×œ ×œMP3, ×•××– ×œ×”×›× ×™×¡ ×”×›×œ ×‘×¤×•×© ××—×“ ×œ× ×•×˜×‘×•×§ ×œ×, ×©×™×’×™×“ ×× ×”×•× ××–×”×” ×¡×¨×˜×•× ×™× ×‘×¢×™×™×ª×™× ×œ×™×œ×“×™× ×“×ª×™×™× ×™×”×•×“×™×™×, ×•×× ×›×Ÿ ×©×™×¦×˜×˜ ×œ××” ×•×©× ×”×¡×¨×˜×•×Ÿ, ×•×× ×™ ××¡×™×¨, ××¤×©×¨ ×œ×¡×§×•×¨ ×›××” ×•×›××” ×¡×¨×˜×•× ×™× ×›××œ×•, ××¤×™×œ×• ×œ×œ×›×ª ×œ×¦×¤×•×ª ×•×œ×”×‘×™×Ÿ ×× ×–×” × ×©××¢ ×‘×××ª ××•×–×¨ ××• ×©×”×•× ×œ× ×××™×Ÿ, ×× ×œ× ×××™×Ÿ, ××– ×× ×™ ×¤×©×•×˜ ××©×™× ××ª ×”×›×œ ×‘×¤×œ×™×™×œ×™×¡×˜ ××—×“, ×× ×××™×Ÿ, ××– ×× ×™ ×¤×©×•×˜ ××¡×™×¨ ×•××©××¨ ×¢× ×¤×—×•×ª ×¡×¨×˜×•× ×™×.. ×”×¨×‘×” ×¢×‘×•×“×”, ×œ× ×™×•×“×¢, ×‘× ×ª×™×™× ×–×” ××—×œ×¥ ××ª ×”×¡×¨×˜×•× ×™× ××”×™×•×˜×™×•×‘, × ×—×™×” ×•× ×¨××”
